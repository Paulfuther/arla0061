{% extends "layout.html" %}


{% block content%}


           


    <div class="container">  

                <nav class="app-nav">

                  <ul class = "app-menu">

                        {% if current_user.has_roles('GSA') %}
                        {% else %}

                       
                       
                       
                  
                        <ul>
                        <form method="POST" class = "hrsearch">
                           
                                <div><input type ="text"  id = "live_search_first" name = "text" placeholder = " Search " class = "inputform mt-3"> 
                                </div>
                                
                        </form>
                        </ul>
                        {% endif %}
                    </ul>
                </nav>
    </div>    
               


                            <div id="table-container"  >

                            </div>
                     
                           

                        <script>


                                    $(document).ready(function() {
                                    $('#live_search_first').on('input', function() {
                                        var query = $(this).val();
                                        if (query.length >= 1) {
                                        // Send an AJAX request to the search route with the query parameter
                                        $.ajax({
                                            url: '/livesearch',
                                            type: 'GET',
                                            dataType: 'json',
                                            data: {
                                            text: query
                                            },
                                                    success: function(response) {
                                                        var user=response
                                                        console.log(user)
                                                    // Generate the dynamic table using the search results
                                                    var tableRows = '';
                                                        user.forEach(function(user) {
                                                            console.log(user.firstname)
                                                          
                                                            tableRows += '<tr class="row">';
                                                            tableRows += '<td class="col  >' + user.id + '</td>';
                                                            tableRows += '<td class="col >' + user.firstname + ' ' +user.lastname+ '</td>';
                                                            tableRows += '<td class="col text-beginning">' + user.email + '</td>';
                                                            tableRows += '<td class="col "><button class="btn btn-primary btn-sm  edit-button" data-id="' + user.id + '">Edit</button></td>';
                                                        
                                                          

                                                        });

                                                        // Add the generated table rows to the table body
                                                        $('#table-container').html('<table>' + tableRows + '</table>');

                                                        $('.edit-button').click(function() {
                                                        var userId = $(this).data('id');
                                                        // Perform the desired action with the user ID
                                                        console.log('Edit button clicked for user ID:', userId);
                                                        window.location.href = "/updategsa" + userId;
                                                    });
                                                    
                                                                                                            },
                                                                                                        })
                                                                                                    }
                                                                                                }
                                                                                        )
                                                                                            }
                                                                                        )
                                                                                                    

                        </script>
                        
                        
{% endblock content %}


