{% extends "layout.html" %}


{% block content%}


           


    <div class="container">  

                <nav class="app-nav">

                  <ul class = "app-menu">

                        {% if current_user.has_roles('GSA') %}
                        {% else %}

                       
                       
                       
                  
                        <ul>
                        <form method="POST" class = "hrsearch">
                           
                                <div><input type ="text"  id = "live_search_first" name = "text" placeholder = " Search " class = "inputform mt-3"> 
                                </div>
                                
                        </form>
                        </ul>
                        {% endif %}
                    </ul>
                </nav>
    </div>    
               


                            <div id="table-container" class="card mx-auto w-90 p-2 border-0" >

                            </div>
                     
                           

                        <script>

                    $(document).ready(function(){
                        $("#live_search_first").on("input",function(e){
                            textinlivebox= $("#live_search_first").val();
                            
                            $.ajax({
                                method:"POST",
                                url:"/livesearch",
                                data:{text:textinlivebox},
                                success:function(res){
                                    console.log(res)
                                    $('#table-container').empty();
                                
                                    let html = res.reduce(( acc, {number, firstname, lastname, email, store, store_id, image_file, id}) =>
                                        acc += `
                                        <div class="row justify-content-md-center mb-2">
                                        <span class="border-bottom mb-2 mx-auto w-90"></span>
                                       
                                
                                        <div class="col-6 col-sm-3 col-md-2">
                                        ${number}
                                        </div>
                                       <div class = "col-6 col-sm- 5 col-md-2 text-end">
                                        ${firstname +" "+ lastname}
                                        </div>
                                        <div class= "col-10 col-sm-10 col-md-5 text-beginning">
                                        ${email}
                                        </div> 
                                        <div class = "col-2 p-1 col-sm-2 col-md-1">
                                        <a href="/updategsa${id}" class="btn btn-primary btn-sm active" role="button" aria-pressed="true">Edit</a>
                                        </div>
                                        </div class="row mb-2">
                                        <div class="row mt-2"></div>
                                        `
                                     

                                    , '');
                                    console.log(res.id)
                                    $('#table-container').append(html);
                                    console.log(res);
                                 
                                }
                            })

                        });
                    })

                        </script>
                        
                        
{% endblock content %}


